.\" Automatically generated by Pandoc 2.18
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "dotnet-restore" "1" "2024-10-02" "" ".NET Documentation"
.hy
.SH dotnet restore
.PP
\f[B]This article applies to:\f[R] \[u2714]\[uFE0F] .NET Core 3.1 SDK and later versions
.SH NAME
.PP
dotnet-restore - Restores the dependencies and tools of a project.
.SH SYNOPSIS
.IP
.nf
\f[C]
dotnet restore [<ROOT>] [--configfile <FILE>] [--disable-build-servers]
    [--disable-parallel]
    [-f|--force] [--force-evaluate] [--ignore-failed-sources]
    [--interactive] [--lock-file-path <LOCK_FILE_PATH>] [--locked-mode]
    [--no-cache] [--no-dependencies] [--packages <PACKAGES_DIRECTORY>]
    [-r|--runtime <RUNTIME_IDENTIFIER>] [-s|--source <SOURCE>]
    [--tl:[auto|on|off]] [--use-current-runtime, --ucr [true|false]]
    [--use-lock-file] [-v|--verbosity <LEVEL>]

dotnet restore -h|--help
\f[R]
.fi
.SH DESCRIPTION
.PP
A .NET project typically references external libraries in NuGet (https://www.nuget.org) packages that provide additional functionality.
These external dependencies are referenced in the project file (\f[I].csproj\f[R] or \f[I].vbproj\f[R]).
When you run the \f[V]dotnet restore\f[R] command, the .NET CLI uses NuGet to look for these dependencies and download them if necessary.
It also ensures that all the dependencies required by the project are compatible with each other and that there are no conflicts between them.
Once the command is completed, all the dependencies required by the project are available in a local cache and can be used by the .NET CLI to build and run the application.
.PP
In most cases, you don\[cq]t need to explicitly use the \f[V]dotnet restore\f[R] command, since if a NuGet restore is necessary, the following commands run it implicitly:
.IP \[bu] 2
\f[V]dotnet new\f[R]
.IP \[bu] 2
\f[V]dotnet build\f[R]
.IP \[bu] 2
\f[V]dotnet build-server\f[R]
.IP \[bu] 2
\f[V]dotnet run\f[R]
.IP \[bu] 2
\f[V]dotnet test\f[R]
.IP \[bu] 2
\f[V]dotnet publish\f[R]
.IP \[bu] 2
\f[V]dotnet pack\f[R]
.PP
Sometimes, it might be inconvenient to run the implicit NuGet restore with these commands.
For example, some automated systems, such as build systems, need to call \f[V]dotnet restore\f[R] explicitly to control when the restore occurs so that they can control network usage.
To prevent the implicit NuGet restore, you can use the \f[V]--no-restore\f[R] flag with any of these commands.
.RS
.PP
Signed package verification during restore operations requires a certificate root store that is valid for both code signing and timestamping.
For more inforomation, see NuGet signed package verification.
.RE
.SS Specify feeds
.PP
To restore the dependencies, NuGet needs the feeds where the packages are located.
Feeds are usually provided via the \f[I]nuget.config\f[R] configuration file.
A default configuration file is provided when the .NET SDK is installed.
To specify additional feeds, do one of the following:
.IP \[bu] 2
Create your own \f[I]nuget.config\f[R] file in the project directory.
For more information, see Common NuGet configurations and nuget.config differences later in this article.
.IP \[bu] 2
Use \f[V]dotnet nuget\f[R] commands such as \f[V]dotnet nuget add source\f[R].
.PP
You can override the \f[I]nuget.config\f[R] feeds with the \f[V]-s\f[R] option.
.PP
For information about how to use authenticated feeds, see Consuming packages from authenticated feeds.
.SS Global packages folder
.PP
For dependencies, you can specify where the restored packages are placed during the restore operation using the \f[V]--packages\f[R] argument.
If not specified, the default NuGet package cache is used, which is found in the \f[V].nuget/packages\f[R] directory in the user\[cq]s home directory on all operating systems.
For example, \f[I]/home/user1\f[R] on Linux or \f[I]C:\f[R] on Windows.
.SS Project-specific tooling
.PP
For project-specific tooling, \f[V]dotnet restore\f[R] first restores the package in which the tool is packed, and then proceeds to restore the tool\[cq]s dependencies as specified in its project file.
.SS nuget.config differences
.PP
The behavior of the \f[V]dotnet restore\f[R] command is affected by the settings in the \f[I]nuget.config\f[R] file, if present.
For example, setting the \f[V]globalPackagesFolder\f[R] in \f[I]nuget.config\f[R] places the restored NuGet packages in the specified folder.
This is an alternative to specifying the \f[V]--packages\f[R] option on the \f[V]dotnet restore\f[R] command.
For more information, see the nuget.config reference.
.PP
There are three specific settings that \f[V]dotnet restore\f[R] ignores:
.IP \[bu] 2
bindingRedirects
.RS 2
.PP
Binding redirects don\[cq]t work with \f[V]<PackageReference>\f[R] elements and .NET only supports \f[V]<PackageReference>\f[R] elements for NuGet packages.
.RE
.IP \[bu] 2
solution
.RS 2
.PP
This setting is Visual Studio specific and doesn\[cq]t apply to .NET.
\&.NET doesn\[cq]t use a \f[V]packages.config\f[R] file and instead uses \f[V]<PackageReference>\f[R] elements for NuGet packages.
.RE
.IP \[bu] 2
trustedSigners
.RS 2
.PP
Support for cross-platform package signature verification was added in the .NET 5.0.100 SDK.
.RE
.SS Workload manifest downloads
.PP
When you run this command, it initiates an asynchronous background download of advertising manifests for workloads.
If the download is still running when this command finishes, the download is stopped.
For more information, see Advertising manifests.
.SH ARGUMENTS
.IP \[bu] 2
\f[B]\f[VB]ROOT\f[B]\f[R]
.RS 2
.PP
Optional path to the project file to restore.
.RE
.SH OPTIONS
.IP \[bu] 2
\f[B]\f[VB]-a|--arch <ARCHITECTURE>\f[B]\f[R]
.RS 2
.PP
Specifies the target architecture.
This is a shorthand syntax for setting the Runtime Identifier (RID), where the provided value is combined with the default RID.
For example, on a \f[V]win-x64\f[R] machine, specifying \f[V]--arch x86\f[R] sets the RID to \f[V]win-x86\f[R].
If you use this option, don\[cq]t use the \f[V]-r|--runtime\f[R] option.
Available since .NET 6 Preview 7.
.RE
.IP \[bu] 2
\f[B]\f[VB]--configfile <FILE>\f[B]\f[R]
.RS 2
.PP
The NuGet configuration file (\f[I]nuget.config\f[R]) to use.
If specified, only the settings from this file will be used.
If not specified, the hierarchy of configuration files from the current directory will be used.
For more information, see Common NuGet Configurations.
.RE
.IP \[bu] 2
\f[B]\f[VB]--disable-build-servers\f[B]\f[R]
.RS 2
.PP
Forces the command to ignore any persistent build servers.
This option provides a consistent way to disable all use of build caching, which forces a build from scratch.
A build that doesn\[cq]t rely on caches is useful when the caches might be corrupted or incorrect for some reason.
Available since .NET 7 SDK.
.RE
.IP \[bu] 2
\f[B]\f[VB]--disable-parallel\f[B]\f[R]
.RS 2
.PP
Disables restoring multiple projects in parallel.
.RE
.IP \[bu] 2
\f[B]\f[VB]--force\f[B]\f[R]
.RS 2
.PP
Forces all dependencies to be resolved even if the last restore was successful.
Specifying this flag is the same as deleting the \f[I]project.assets.json\f[R] file.
.RE
.IP \[bu] 2
\f[B]\f[VB]--force-evaluate\f[B]\f[R]
.RS 2
.PP
Forces restore to reevaluate all dependencies even if a lock file already exists.
.RE
.IP \[bu] 2
\f[B]\f[VB]-?|-h|--help\f[B]\f[R]
.RS 2
.PP
Prints out a description of how to use the command.
.RE
.IP \[bu] 2
\f[B]\f[VB]--ignore-failed-sources\f[B]\f[R]
.RS 2
.PP
Only warn about failed sources if there are packages meeting the version requirement.
.RE
.IP \[bu] 2
\f[B]\f[VB]--interactive\f[B]\f[R]
.RS 2
.PP
Allows the command to stop and wait for user input or action.
For example, to complete authentication.
.RE
.IP \[bu] 2
\f[B]\f[VB]--lock-file-path <LOCK_FILE_PATH>\f[B]\f[R]
.RS 2
.PP
Output location where project lock file is written.
By default, this is \f[I]PROJECT_ROOT.lock.json\f[R].
.RE
.IP \[bu] 2
\f[B]\f[VB]--locked-mode\f[B]\f[R]
.RS 2
.PP
Don\[cq]t allow updating project lock file.
.RE
.IP \[bu] 2
\f[B]\f[VB]--no-cache\f[B]\f[R]
.RS 2
.PP
Specifies to not cache HTTP requests.
.RE
.IP \[bu] 2
\f[B]\f[VB]--no-dependencies\f[B]\f[R]
.RS 2
.PP
When restoring a project with project-to-project (P2P) references, restores the root project and not the references.
.RE
.IP \[bu] 2
\f[B]\f[VB]--packages <PACKAGES_DIRECTORY>\f[B]\f[R]
.RS 2
.PP
Specifies the directory for restored packages.
.RE
.IP \[bu] 2
\f[B]\f[VB]-r|--runtime <RUNTIME_IDENTIFIER>\f[B]\f[R]
.RS 2
.PP
Specifies a runtime for the package restore.
This is used to restore packages for runtimes not explicitly listed in the \f[V]<RuntimeIdentifiers>\f[R] tag in the \f[I].csproj\f[R] file.
For a list of Runtime Identifiers (RIDs), see the RID catalog.
.RE
.IP \[bu] 2
\f[B]\f[VB]-s|--source <SOURCE>\f[B]\f[R]
.RS 2
.PP
Specifies the URI of the NuGet package source to use during the restore operation.
This setting overrides all of the sources specified in the \f[I]nuget.config\f[R] files.
Multiple sources can be provided by specifying this option multiple times.
.RE
.IP \[bu] 2
\f[B]\f[VB]--tl:[auto|on|off]\f[B]\f[R]
.RS 2
.PP
Specifies whether the \f[I]terminal logger\f[R] should be used for the build output.
The default is \f[V]auto\f[R], which first verifies the environment before enabling terminal logging.
The environment check verifies that the terminal is capable of using modern output features and isn\[cq]t using a redirected standard output before enabling the new logger.
\f[V]on\f[R] skips the environment check and enables terminal logging.
\f[V]off\f[R] skips the environment check and uses the default console logger.
.PP
The terminal logger shows you the restore phase followed by the build phase.
During each phase, the currently building projects appear at the bottom of the terminal.
Each project that\[cq]s building outputs both the MSBuild target currently being built and the amount of time spent on that target.
You can search this information to learn more about the build.
When a project is finished building, a single \[lq]build completed\[rq] section is written that captures:
.IP \[bu] 2
The name of the built project.
.IP \[bu] 2
The target framework (if multi-targeted).
.IP \[bu] 2
The status of that build.
.IP \[bu] 2
The primary output of that build (which is hyperlinked).
.IP \[bu] 2
Any diagnostics generated for that project.
.PP
This option is available starting in .NET 8.
.RE
.IP \[bu] 2
\f[B]\f[VB]--use-current-runtime, --ucr [true|false]\f[B]\f[R]
.RS 2
.PP
Sets the \f[V]RuntimeIdentifier\f[R] to a platform portable \f[V]RuntimeIdentifier\f[R] based on the one of your machine.
This happens implicitly with properties that require a \f[V]RuntimeIdentifier\f[R], such as \f[V]SelfContained\f[R], \f[V]PublishAot\f[R], \f[V]PublishSelfContained\f[R], \f[V]PublishSingleFile\f[R], and \f[V]PublishReadyToRun\f[R].
If the property is set to false, that implicit resolution will no longer occur.
.RE
.IP \[bu] 2
\f[B]\f[VB]--use-lock-file\f[B]\f[R]
.RS 2
.PP
Enables project lock file to be generated and used with restore.
.RE
.IP \[bu] 2
\f[B]\f[VB]-v|--verbosity <LEVEL>\f[B]\f[R]
.RS 2
.PP
Sets the verbosity level of the command.
Allowed values are \f[V]q[uiet]\f[R], \f[V]m[inimal]\f[R], \f[V]n[ormal]\f[R], \f[V]d[etailed]\f[R], and \f[V]diag[nostic]\f[R].
The default is \f[V]minimal\f[R].
For more information, see <xref:Microsoft.Build.Framework.LoggerVerbosity>.
.RE
.SH EXAMPLES
.IP \[bu] 2
Restore dependencies and tools for the project in the current directory:
.RS 2
.IP
.nf
\f[C]
dotnet restore
\f[R]
.fi
.RE
.IP \[bu] 2
Restore dependencies and tools for the \f[V]app1\f[R] project found in the given path:
.RS 2
.IP
.nf
\f[C]
dotnet restore ./projects/app1/app1.csproj
\f[R]
.fi
.RE
.IP \[bu] 2
Restore the dependencies and tools for the project in the current directory using the file path provided as the source:
.RS 2
.IP
.nf
\f[C]
dotnet restore -s c:\[rs]packages\[rs]mypackages
\f[R]
.fi
.RE
.IP \[bu] 2
Restore the dependencies and tools for the project in the current directory using the two file paths provided as sources:
.RS 2
.IP
.nf
\f[C]
dotnet restore -s c:\[rs]packages\[rs]mypackages -s c:\[rs]packages\[rs]myotherpackages
\f[R]
.fi
.RE
.IP \[bu] 2
Restore dependencies and tools for the project in the current directory showing detailed output:
.RS 2
.IP
.nf
\f[C]
dotnet restore --verbosity detailed
\f[R]
.fi
.RE
.SS Audit for security vulnerabilities
.PP
Starting in .NET 8, \f[V]dotnet restore\f[R] includes NuGet security auditing.
This auditing produces a report of security vulnerabilities with the affected package name, the severity of the vulnerability, and a link to the advisory for more details.
.PP
To opt out of the security auditing, set the \f[V]<NuGetAudit>\f[R] MSBuild property to \f[V]false\f[R] in your project file.
.PP
To retrieve the known vulnerability dataset, ensure that you have the NuGet.org central registry defined as one of your package sources:
.IP
.nf
\f[C]
<packageSources>
    <add key=\[dq]nuget.org\[dq] value=\[dq]https://api.nuget.org/v3/index.json\[dq] protocolVersion=\[dq]3\[dq] />
</packageSources>
\f[R]
.fi
.PP
You can configure the level at which auditing will fail by setting the \f[V]<NuGetAuditLevel>\f[R] MSBuild property.
Possible values are \f[V]low\f[R], \f[V]moderate\f[R], \f[V]high\f[R], and \f[V]critical\f[R].
For example if you only want to see moderate, high, and critical advisories, you can set the property to \f[V]moderate\f[R].
.PP
Starting in .NET 9, NuGet audits both \f[I]direct\f[R] and \f[I]transitive\f[R] package references, by default.
In .NET 8, only \f[I]direct\f[R] package references are audited.
You can change the mode by setting the \f[V]<NuGetAuditMode>\f[R] MSBuild property to \f[V]direct\f[R] or \f[V]all\f[R].
.PP
For more information, see Auditing package dependencies for security vulnerabilities.
