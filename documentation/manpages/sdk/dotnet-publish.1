.\" Automatically generated by Pandoc 2.14.1
.\"
.TH "" "1" "" "" ".NET"
.hy
.SH dotnet publish
.PP
\f[B]This article applies to:\f[R] \[u2714]\[uFE0F] .NET Core 2.1 SDK and later versions
.SH NAME
.PP
\f[C]dotnet publish\f[R] - Publishes the application and its dependencies to a folder for deployment to a hosting system.
.SH SYNOPSIS
.IP
.nf
\f[C]
dotnet publish [<PROJECT>|<SOLUTION>] [-a|--arch <ARCHITECTURE>]
    [-c|--configuration <CONFIGURATION>]
    [-f|--framework <FRAMEWORK>] [--force] [--interactive]
    [--manifest <PATH_TO_MANIFEST_FILE>] [--no-build] [--no-dependencies]
    [--no-restore] [--nologo] [-o|--output <OUTPUT_DIRECTORY>]
    [--os <OS>] [-r|--runtime <RUNTIME_IDENTIFIER>]
    [--self-contained [true|false]]
    [--no-self-contained] [-v|--verbosity <LEVEL>]
    [--version-suffix <VERSION_SUFFIX>]

dotnet publish -h|--help
\f[R]
.fi
.SH DESCRIPTION
.PP
\f[C]dotnet publish\f[R] compiles the application, reads through its dependencies specified in the project file, and publishes the resulting set of files to a directory.
The output includes the following assets:
.IP \[bu] 2
Intermediate Language (IL) code in an assembly with a \f[I]dll\f[R] extension.
.IP \[bu] 2
A \f[I].deps.json\f[R] file that includes all of the dependencies of the project.
.IP \[bu] 2
A \f[I].runtimeconfig.json\f[R] file that specifies the shared runtime that the application expects, as well as other configuration options for the runtime (for example, garbage collection type).
.IP \[bu] 2
The application\[cq]s dependencies, which are copied from the NuGet cache into the output folder.
.PP
The \f[C]dotnet publish\f[R] command\[cq]s output is ready for deployment to a hosting system (for example, a server, PC, Mac, laptop) for execution.
It\[cq]s the only officially supported way to prepare the application for deployment.
Depending on the type of deployment that the project specifies, the hosting system may or may not have the .NET shared runtime installed on it.
For more information, see Publish .NET apps with the .NET CLI.
.SS Implicit restore
.PP
You don\[cq]t have to run \f[C]dotnet restore\f[R] because it\[cq]s run implicitly by all commands that require a restore to occur, such as \f[C]dotnet new\f[R], \f[C]dotnet build\f[R], \f[C]dotnet run\f[R], \f[C]dotnet test\f[R], \f[C]dotnet publish\f[R], and \f[C]dotnet pack\f[R].
To disable implicit restore, use the \f[C]--no-restore\f[R] option.
.PP
The \f[C]dotnet restore\f[R] command is still useful in certain scenarios where explicitly restoring makes sense, such as continuous integration builds in Azure DevOps Services or in build systems that need to explicitly control when the restore occurs.
.PP
For information about how to manage NuGet feeds, see the \f[C]dotnet restore\f[R] documentation.
.SS MSBuild
.PP
The \f[C]dotnet publish\f[R] command calls MSBuild, which invokes the \f[C]Publish\f[R] target.
If the \f[C]IsPublishable\f[R] property is set to \f[C]false\f[R] for a particular project, the \f[C]Publish\f[R] target can\[cq]t be invoked, and the \f[C]dotnet publish\f[R] command only runs the implicit dotnet restore on the project.
.PP
Any parameters passed to \f[C]dotnet publish\f[R] are passed to MSBuild.
The \f[C]-c\f[R] and \f[C]-o\f[R] parameters map to MSBuild\[cq]s \f[C]Configuration\f[R] and \f[C]PublishDir\f[R] properties, respectively.
.PP
The \f[C]dotnet publish\f[R] command accepts MSBuild options, such as \f[C]-p\f[R] for setting properties and \f[C]-l\f[R] to define a logger.
For example, you can set an MSBuild property by using the format: \f[C]-p:<NAME>=<VALUE>\f[R].
.PP
You can also set publish-related properties by referring to a \f[I].pubxml\f[R] file (available since .NET Core 3.1 SDK).
For example:
.IP
.nf
\f[C]
dotnet publish -p:PublishProfile=FolderProfile
\f[R]
.fi
.PP
The preceding example uses the \f[I]FolderProfile.pubxml\f[R] file that is found in the \f[I]<project_folder>/Properties/PublishProfiles\f[R] folder.
If you specify a path and file extension when setting the \f[C]PublishProfile\f[R] property, they are ignored.
MSBuild by default looks in the \f[I]Properties/PublishProfiles\f[R] folder and assumes the \f[I]pubxml\f[R] file extension.
To specify the path and filename including extension, set the \f[C]PublishProfileFullPath\f[R] property instead of the \f[C]PublishProfile\f[R] property.
.PP
The following MSBuild properties change the output of \f[C]dotnet publish\f[R].
.IP \[bu] 2
\f[C]PublishReadyToRun\f[R]
.RS 2
.PP
Compiles application assemblies as ReadyToRun (R2R) format.
R2R is a form of ahead-of-time (AOT) compilation.
For more information, see ReadyToRun images.
Available since .NET Core 3.0 SDK.
.PP
To see warnings about missing dependencies that could cause runtime failures, use \f[C]PublishReadyToRunShowWarnings=true\f[R].
.PP
We recommend that you specify \f[C]PublishReadyToRun\f[R] in a publish profile rather than on the command line.
.RE
.IP \[bu] 2
\f[C]PublishSingleFile\f[R]
.RS 2
.PP
Packages the app into a platform-specific single-file executable.
For more information about single-file publishing, see the single-file bundler design document (https://github.com/dotnet/designs/blob/main/accepted/2020/single-file/design.md).
Available since .NET Core 3.0 SDK.
.PP
We recommend that you specify this option in the project file rather than on the command line.
.RE
.IP \[bu] 2
\f[C]PublishTrimmed\f[R]
.RS 2
.PP
Trims unused libraries to reduce the deployment size of an app when publishing a self-contained executable.
For more information, see Trim self-contained deployments and executables.
Available since .NET Core 3.0 SDK as a preview feature.
.PP
We recommend that you specify this option in the project file rather than on the command line.
.RE
.PP
For more information, see the following resources:
.IP \[bu] 2
MSBuild command-line reference
.IP \[bu] 2
Visual Studio publish profiles (.pubxml) for ASP.NET Core app deployment
.IP \[bu] 2
dotnet msbuild
.SS Workload manifest downloads
.PP
When you run this command, it initiates an asynchronous background download of advertising manifests for workloads.
If the download is still running when this command finishes, the download is stopped.
For more information, see Advertising manifests.
.SS Arguments
.IP \[bu] 2
\f[B]\f[CB]PROJECT|SOLUTION\f[B]\f[R]
.RS 2
.PP
The project or solution to publish.
.IP \[bu] 2
\f[C]PROJECT\f[R] is the path and filename of a C#, F#, or Visual Basic project file, or the path to a directory that contains a C#, F#, or Visual Basic project file.
If the directory is not specified, it defaults to the current directory.
.IP \[bu] 2
\f[C]SOLUTION\f[R] is the path and filename of a solution file (\f[I].sln\f[R] extension), or the path to a directory that contains a solution file.
If the directory is not specified, it defaults to the current directory.
Available since .NET Core 3.0 SDK.
.RE
.SH OPTIONS
.IP \[bu] 2
\f[B]\f[CB]-a|--arch <ARCHITECTURE>\f[B]\f[R]
.RS 2
.PP
Specifies the target architecture.
This is a shorthand syntax for setting the Runtime Identifier (RID), where the provided value is combined with the default RID.
For example, on a \f[C]win-x64\f[R] machine, specifying \f[C]--arch x86\f[R] sets the RID to \f[C]win-x86\f[R].
If you use this option, don\[cq]t use the \f[C]-r|--runtime\f[R] option.
Available since .NET 6 Preview 7.
.RE
.IP \[bu] 2
\f[B]\f[CB]-c|--configuration <CONFIGURATION>\f[B]\f[R]
.RS 2
.PP
Defines the build configuration.
The default for most projects is \f[C]Debug\f[R], but you can override the build configuration settings in your project.
.RE
.IP \[bu] 2
\f[B]\f[CB]-f|--framework <FRAMEWORK>\f[B]\f[R]
.RS 2
.PP
Publishes the application for the specified target framework.
You must specify the target framework in the project file.
.RE
.IP \[bu] 2
\f[B]\f[CB]--force\f[B]\f[R]
.RS 2
.PP
Forces all dependencies to be resolved even if the last restore was successful.
Specifying this flag is the same as deleting the \f[I]project.assets.json\f[R] file.
.RE
.IP \[bu] 2
\f[B]\f[CB]-?|-h|--help\f[B]\f[R]
.RS 2
.PP
Prints out a description of how to use the command.
.RE
.IP \[bu] 2
\f[B]\f[CB]--interactive\f[B]\f[R]
.RS 2
.PP
Allows the command to stop and wait for user input or action.
For example, to complete authentication.
Available since .NET Core 3.0 SDK.
.RE
.IP \[bu] 2
\f[B]\f[CB]--manifest <PATH_TO_MANIFEST_FILE>\f[B]\f[R]
.RS 2
.PP
Specifies one or several target manifests to use to trim the set of packages published with the app.
The manifest file is part of the output of the \f[C]dotnet store\f[R] command.
To specify multiple manifests, add a \f[C]--manifest\f[R] option for each manifest.
.RE
.IP \[bu] 2
\f[B]\f[CB]--no-build\f[B]\f[R]
.RS 2
.PP
Doesn\[cq]t build the project before publishing.
It also implicitly sets the \f[C]--no-restore\f[R] flag.
.RE
.IP \[bu] 2
\f[B]\f[CB]--no-dependencies\f[B]\f[R]
.RS 2
.PP
Ignores project-to-project references and only restores the root project.
.RE
.IP \[bu] 2
\f[B]\f[CB]--nologo\f[B]\f[R]
.RS 2
.PP
Doesn\[cq]t display the startup banner or the copyright message.
Available since .NET Core 3.0 SDK.
.RE
.IP \[bu] 2
\f[B]\f[CB]--no-restore\f[B]\f[R]
.RS 2
.PP
Doesn\[cq]t execute an implicit restore when running the command.
.RE
.IP \[bu] 2
\f[B]\f[CB]-o|--output <OUTPUT_DIRECTORY>\f[B]\f[R]
.RS 2
.PP
Specifies the path for the output directory.
.PP
If not specified, it defaults to \f[I][project_file_folder]/bin/[configuration]/[framework]/publish/\f[R] for a framework-dependent executable and cross-platform binaries.
It defaults to \f[I][project_file_folder]/bin/[configuration]/[framework]/[runtime]/publish/\f[R] for a self-contained executable.
.PP
In a web project, if the output folder is in the project folder, successive \f[C]dotnet publish\f[R] commands result in nested output folders.
For example, if the project folder is \f[I]myproject\f[R], and the publish output folder is \f[I]myproject/publish\f[R], and you run \f[C]dotnet publish\f[R] twice, the second run puts content files such as \f[I].config\f[R] and \f[I].json\f[R] files in \f[I]myproject/publish/publish\f[R].
To avoid nesting publish folders, specify a publish folder that is not \f[B]directly\f[R] under the project folder, or exclude the publish folder from the project.
To exclude a publish folder named \f[I]publishoutput\f[R], add the following element to a \f[C]PropertyGroup\f[R] element in the \f[I].csproj\f[R] file:
.IP
.nf
\f[C]
<DefaultItemExcludes>$(DefaultItemExcludes);publishoutput**</DefaultItemExcludes>
\f[R]
.fi
.IP \[bu] 2
\&.NET Core 3.x SDK and later
.RS 2
.PP
If you specify a relative path when publishing a project, the generated output directory is relative to the current working directory, not to the project file location.
.PP
If you specify a relative path when publishing a solution, all output for all projects goes into the specified folder relative to the current working directory.
To make publish output go to separate folders for each project, specify a relative path by using the msbuild \f[C]PublishDir\f[R] property instead of the \f[C]--output\f[R] option.
For example, \f[C]dotnet publish -p:PublishDir=.\[rs]publish\f[R] sends publish output for each project to a \f[C]publish\f[R] folder under the folder that contains the project file.
.RE
.IP \[bu] 2
\&.NET Core 2.x SDK
.RS 2
.PP
If you specify a relative path when publishing a project, the generated output directory is relative to the project file location, not to the current working directory.
.PP
If you specify a relative path when publishing a solution, each project\[cq]s output goes into a separate folder relative to the project file location.
If you specify an absolute path when publishing a solution, all publish output for all projects goes into the specified folder.
.RE
.RE
.IP \[bu] 2
\f[B]\f[CB]--os <OS>\f[B]\f[R]
.RS 2
.PP
Specifies the target operating system (OS).
This is a shorthand syntax for setting the Runtime Identifier (RID), where the provided value is combined with the default RID.
For example, on a \f[C]win-x64\f[R] machine, specifying \f[C]--os os\f[R] sets the RID to \f[C]os-x64\f[R].
If you use this option, don\[cq]t use the \f[C]-r|--runtime\f[R] option.
Available since .NET 6 Preview 7.
.RE
.IP \[bu] 2
\f[B]\f[CB]--self-contained [true|false]\f[B]\f[R]
.RS 2
.PP
Publishes the .NET runtime with your application so the runtime doesn\[cq]t need to be installed on the target machine.
Default is \f[C]true\f[R] if a runtime identifier is specified and the project is an executable project (not a library project).
For more information, see .NET application publishing and Publish .NET apps with the .NET CLI.
.PP
If this option is used without specifying \f[C]true\f[R] or \f[C]false\f[R], the default is \f[C]true\f[R].
In that case, don\[cq]t put the solution or project argument immediately after \f[C]--self-contained\f[R], because \f[C]true\f[R] or \f[C]false\f[R] is expected in that position.
.RE
.IP \[bu] 2
\f[B]\f[CB]--no-self-contained\f[B]\f[R]
.RS 2
.PP
Equivalent to \f[C]--self-contained false\f[R].
Available since .NET Core 3.0 SDK.
.RE
.IP \[bu] 2
\f[B]\f[CB]-r|--runtime <RUNTIME_IDENTIFIER>\f[B]\f[R]
.RS 2
.PP
Publishes the application for a given runtime.
For a list of Runtime Identifiers (RIDs), see the RID catalog.
For more information, see .NET application publishing and Publish .NET apps with the .NET CLI.
If you use this option, use \f[C]--self-contained\f[R] or \f[C]--no-self-contained\f[R] also.
.RE
.IP \[bu] 2
\f[B]\f[CB]-v|--verbosity <LEVEL>\f[B]\f[R]
.RS 2
.PP
Sets the verbosity level of the command.
Allowed values are \f[C]q[uiet]\f[R], \f[C]m[inimal]\f[R], \f[C]n[ormal]\f[R], \f[C]d[etailed]\f[R], and \f[C]diag[nostic]\f[R].
The default is \f[C]minimal\f[R].
For more information, see <xref:Microsoft.Build.Framework.LoggerVerbosity>.
.RE
.IP \[bu] 2
\f[B]\f[CB]--version-suffix <VERSION_SUFFIX>\f[B]\f[R]
.RS 2
.PP
Defines the version suffix to replace the asterisk (\f[C]*\f[R]) in the version field of the project file.
.RE
.SH EXAMPLES
.IP \[bu] 2
Create a framework-dependent cross-platform binary for the project in the current directory:
.RS 2
.IP
.nf
\f[C]
dotnet publish
\f[R]
.fi
.PP
Starting with .NET Core 3.0 SDK, this example also creates a framework-dependent executable for the current platform.
.RE
.IP \[bu] 2
Create a self-contained executable for the project in the current directory, for a specific runtime:
.RS 2
.IP
.nf
\f[C]
dotnet publish --runtime osx.10.11-x64
\f[R]
.fi
.PP
The RID must be in the project file.
.RE
.IP \[bu] 2
Create a framework-dependent executable for the project in the current directory, for a specific platform:
.RS 2
.IP
.nf
\f[C]
dotnet publish --runtime osx.10.11-x64 --self-contained false
\f[R]
.fi
.PP
The RID must be in the project file.
This example applies to .NET Core 3.0 SDK and later versions.
.RE
.IP \[bu] 2
Publish the project in the current directory, for a specific runtime and target framework:
.RS 2
.IP
.nf
\f[C]
dotnet publish --framework netcoreapp3.1 --runtime osx.10.11-x64
\f[R]
.fi
.RE
.IP \[bu] 2
Publish the specified project file:
.RS 2
.IP
.nf
\f[C]
dotnet publish \[ti]/projects/app1/app1.csproj
\f[R]
.fi
.RE
.IP \[bu] 2
Publish the current application but don\[cq]t restore project-to-project (P2P) references, just the root project during the restore operation:
.RS 2
.IP
.nf
\f[C]
dotnet publish --no-dependencies
\f[R]
.fi
.RE
.SS See also
.IP \[bu] 2
\&.NET application publishing overview
.IP \[bu] 2
Publish .NET apps with the .NET CLI
.IP \[bu] 2
Target frameworks
.IP \[bu] 2
Runtime Identifier (RID) catalog
.IP \[bu] 2
Working with macOS Catalina Notarization
.IP \[bu] 2
Directory structure of a published application
.IP \[bu] 2
MSBuild command-line reference
.IP \[bu] 2
Visual Studio publish profiles (.pubxml) for ASP.NET Core app deployment
.IP \[bu] 2
dotnet msbuild
.IP \[bu] 2
ILLInk.Tasks
