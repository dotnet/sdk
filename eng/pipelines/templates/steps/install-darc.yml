parameters:
  - name: workingDirectory
    type: string
    default: '$(Build.SourcesDirectory)'

steps:
- powershell: |
    $ErrorActionPreference = 'Stop'
    . .\eng\common\tools.ps1
    $dotnetRoot = InitializeDotNetCli -install:$true
    $dotnet = "$dotnetRoot\dotnet.exe"
    & "$dotnet" tool restore
  displayName: ðŸŸ£ Install darc (Windows)
  condition: eq(variables['Agent.OS'], 'Windows_NT')
  workingDirectory: ${{ parameters.workingDirectory }}

- script: |
    set -ex
    . ./eng/common/tools.sh
    dotnetRoot=$(InitializeDotNetCli --install)
    dotnet="$dotnetRoot/dotnet"
    $dotnet tool restore
  displayName: ðŸŸ£ Install darc (Unix)
  condition: ne(variables['Agent.OS'], 'Windows_NT')
  workingDirectory: ${{ parameters.workingDirectory }}
