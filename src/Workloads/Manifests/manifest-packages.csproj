<Project Sdk="Microsoft.Build.Traversal" DefaultTargets="Pack">

  <ItemGroup>
    <ProjectReference Include="**\*.Manifest.proj" />
  </ItemGroup>

  <Target Name="LayoutBuiltinManifests">

    <PropertyGroup>
      <_VersionOverride Condition="'$(DotNet1xxWorkloadManifestVersion)' != ''">Version=$(DotNet1xxWorkloadManifestVersion)</_VersionOverride>
    </PropertyGroup>

    <MSBuild Projects="@(ProjectReference)"
             Targets="LayoutManifest"
             Properties="ManifestDirectory=$(ManifestDirectory);$(_VersionOverride)" />
  </Target>

</Project>