<Project Sdk="Microsoft.DotNet.Helix.Sdk">

  <PropertyGroup>
    <HelixType>test/product/</HelixType>
    <Creator Condition="'$(BUILD_BUILDNUMBER)' != ''">sdk-dev</Creator>

    <IncludeDotNetCli>false</IncludeDotNetCli>

    <EnableAzurePipelinesReporter Condition="'$(BUILD_BUILDNUMBER)' != ''">true</EnableAzurePipelinesReporter>

    <EnableXUnitReporter>true</EnableXUnitReporter>
  </PropertyGroup>

  <ItemGroup>
    <XUnitProject Include="**\*.Tests.csproj"/>

  </ItemGroup>

  <ItemGroup Condition=" '$(HelixAccessToken)' != '' ">
    <HelixTargetQueue Include="Windows.10.Amd64"/>
  </ItemGroup>

  <ItemGroup Condition=" '$(HelixAccessToken)' == '' ">
    <HelixTargetQueue Include="Windows.10.Amd64.Open"/>
  </ItemGroup>

  <!-- need to be a target in order to have IsPosixShell available  -->
  <Target Name="AppendHelixPreCommand" AfterTargets="AddXUnitReporter">
    <PropertyGroup>
      <HelixPreCommands Condition="!$(IsPosixShell)">eng\dogfood.cmd;dotnet msbuild UnzipInHelix.proj;.eng\dogfood.ps1 -MSBuildSDKsPath .eng\dogfood.ps1 -MSBuildSDKsPath (Resolve-Path -Path s).Path;cmd;$(HelixPreCommands)</HelixPreCommands>
      <HelixPreCommands Condition="$(IsPosixShell)">$HELIX_CORRELATION_PAYLOAD/eng/dogfood.sh;$(HelixPreCommands)</HelixPreCommands>
    </PropertyGroup>
  </Target>

</Project>
