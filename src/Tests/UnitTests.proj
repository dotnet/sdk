<Project Sdk="Microsoft.DotNet.Helix.Sdk">

  <PropertyGroup>
    <HelixType>test/product/</HelixType>
    <Creator Condition="'$(BUILD_BUILDNUMBER)' != ''">sdk-dev</Creator>

    <IncludeDotNetCli>false</IncludeDotNetCli>

    <EnableAzurePipelinesReporter Condition="'$(BUILD_BUILDNUMBER)' != ''">true</EnableAzurePipelinesReporter>

    <EnableXUnitReporter>true</EnableXUnitReporter>
  </PropertyGroup>

  <ItemGroup>
    <XUnitProject Include="**\*.Tests.csproj"/>

  </ItemGroup>

  <ItemGroup Condition=" '$(HelixAccessToken)' != '' ">
    <HelixTargetQueue Include="Windows.10.Amd64"/>
  </ItemGroup>

  <ItemGroup Condition=" '$(HelixAccessToken)' == '' ">
    <HelixTargetQueue Include="Windows.10.Amd64.Open"/>
  </ItemGroup>

  <!-- need to be a target in order to have IsPosixShell available  -->
  <Target Name="AppendHelixPreCommand" AfterTargets="AddXUnitReporter">
    <PropertyGroup>
      <HelixPostCommands Condition="$(IsPosixShell)">$(HelixPostCommands);$HELIX_CORRELATION_PAYLOAD/eng/dogfood.cmd;dotnet msbuild UnzipInHelix.proj; -MSBuildSDKsPath $HELIX_CORRELATION_PAYLOAD/s</HelixPostCommands>
      <HelixPostCommands Condition="!$(IsPosixShell)">$(HelixPostCommands);$HELIX_CORRELATION_PAYLOAD/eng/dogfood.sh</HelixPostCommands>
    </PropertyGroup>
  </Target>

</Project>
